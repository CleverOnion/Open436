# M5 - 板块管理模块 PRD

## 模块概述

**模块名称**：板块管理模块  
**模块编号**：M5  
**优先级**：P2（中等优先级）  
**目标用户**：管理员为主，普通用户可浏览

### 业务目标

本模块旨在解决以下核心业务问题：

1. **内容分类**：通过板块对帖子进行分类组织，便于用户查找感兴趣的内容
2. **主题聚焦**：为不同主题的讨论提供独立空间，提升讨论质量
3. **板块管理**：为管理员提供板块的创建、编辑、删除等管理功能
4. **板块配置**：支持板块的个性化设置和展示顺序调整

### 模块边界

> ⚠️ **职责范围**：本模块仅负责板块的组织结构管理和配置，不涉及板块内帖子的管理。帖子管理由 M3 内容管理模块负责。

**与其他模块的关系**：

- **依赖 M1**：验证管理员身份和权限
- **被 M3 依赖**：提供板块信息，验证板块有效性
- **被 M8 依赖**：提供板块统计数据

---

## 功能需求

### 1. 浏览板块列表

#### 1.1 业务场景

**使用场景**：

- 用户在首页侧边栏查看所有板块
- 用户选择板块筛选帖子

**用户故事**：

- 作为一个论坛用户，我希望能够看到所有板块的列表，了解论坛有哪些主题分类。
- 作为一个论坛用户，我希望看到每个板块的帖子数量，选择活跃的板块浏览。

#### 1.2 功能说明

显示所有启用的板块，供用户选择和浏览。

**显示信息**：

每个板块显示：

- 板块名称
- 板块图标
- 板块描述
- 板块内帖子数量
- 板块颜色标识

**显示顺序**：

- 按板块排序号升序排列
- 管理员可以自定义排序

#### 1.3 业务规则

**查看权限**：

- 所有用户都可以查看板块列表
- 仅显示启用状态的板块
- 禁用的板块不显示

**板块状态**：

- 启用：正常显示和使用
- 禁用：不显示在列表中，无法发帖

#### 1.4 交互流程

1. 用户访问首页
2. 左侧侧边栏显示所有板块
3. 显示板块名称、图标、帖子数量
4. 用户点击板块，筛选该板块的帖子
5. 当前选中的板块高亮显示

---

### 2. 创建板块（管理员功能）

#### 2.1 业务场景

**使用场景**：管理员需要为新的主题创建专门的讨论板块。

**用户故事**：

- 作为管理员，我希望能够创建新的板块，为不同主题的讨论提供分类。
- 作为管理员，我希望能够设置板块的名称、图标图片和描述，让用户清楚板块的用途。

#### 2.2 功能说明

管理员在板块管理页面创建新板块。

**输入信息**：

- 板块名称（必填，唯一）
- 板块标识（必填，唯一，英文字符）
- 板块描述（可选）
- 板块图标图片（可选）
- 板块颜色（必填）
- 排序号（必填，数字）

**输出结果**：

- 创建成功：返回板块信息，显示"板块创建成功"提示
- 创建失败：显示错误原因

#### 2.3 业务规则

**板块名称规则**：

- 长度：2-20 个字符
- 必须唯一，不能与现有板块重名
- 不能包含特殊字符

**板块标识规则**：

- 长度：3-20 个字符
- 仅允许英文小写字母、数字、下划线
- 必须唯一
- 用于 URL 路径（如 `/section/tech`）

**板块描述规则**：

- 最大长度：200 个字符
- 简要说明板块的主题和适用范围

**板块图标规则**：

- 支持格式：JPG、PNG、GIF、SVG
- 文件大小：不超过 500KB
- 推荐尺寸：128x128 像素
- 如果不上传图标，使用默认图标

**板块颜色规则**：

- 使用预设的颜色方案（6-8 种）
- 用于板块徽章和标识

**排序号规则**：

- 数字，范围 1-999
- 数字越小，排序越靠前
- 可以有相同的排序号

**初始状态**：

- 新创建的板块默认为启用状态
- 帖子数量初始为 0

#### 2.4 交互流程

1. 管理员进入"板块管理"页面
2. 点击"创建板块"按钮
3. 填写板块信息：
   - 板块名称
   - 板块标识
   - 板块描述
   - 上传板块图标图片（可选）
   - 选择板块颜色
   - 设置排序号
4. 点击"确认创建"
5. 系统验证输入信息
6. 验证通过：
   - 创建板块记录
   - 显示"板块创建成功"提示
   - 返回板块管理页面
7. 验证失败：
   - 显示错误提示
   - 用户可以修改后重新提交

---

### 3. 编辑板块（管理员功能）

#### 3.1 业务场景

**使用场景**：管理员需要修改板块的名称、描述或颜色等信息。

**用户故事**：

- 作为管理员，我希望能够修改板块的名称和描述，让板块定位更清晰。
- 作为管理员，我希望能够调整板块的颜色和图标图片，优化视觉效果。

#### 3.2 功能说明

管理员可以修改板块的基本信息和配置。

**可编辑字段**：

- 板块名称
- 板块描述
- 板块图标图片
- 板块颜色
- 排序号

**不可编辑字段**：

- 板块标识（创建后不可修改）
- 创建时间

**输出结果**：

- 编辑成功：更新板块信息，显示"板块已更新"提示
- 编辑失败：显示错误原因

#### 3.3 业务规则

**编辑权限**：

- 仅管理员可以编辑板块

**验证规则**：

- 与创建板块相同的验证规则
- 板块名称不能与其他板块重复

**影响范围**：

- 修改板块信息后，所有该板块的帖子徽章同步更新
- 不影响已发布的帖子内容

#### 3.4 交互流程

1. 管理员进入"板块管理"页面
2. 找到需要编辑的板块
3. 点击"编辑"按钮
4. 修改板块信息
5. 点击"保存"
6. 系统验证输入信息
7. 验证通过：
   - 更新板块信息
   - 显示"板块已更新"提示
8. 验证失败：
   - 显示错误提示
   - 管理员可以继续修改

---

### 4. 删除板块（管理员功能）

#### 4.1 业务场景

**使用场景**：管理员需要删除不再使用的板块。

**用户故事**：

- 作为管理员，我希望能够删除不再需要的板块，简化板块结构。

#### 4.2 功能说明

管理员可以删除板块。

**删除方式**：

- 软删除：标记为已删除，不再显示，但数据保留
- 硬删除：永久删除数据（需特殊条件）

**删除条件**：

- 仅当板块内没有帖子时，才能硬删除
- 如果板块内有帖子，只能软删除（禁用）

**影响范围**：

- 板块不再显示在板块列表中
- 该板块下的帖子仍然存在
- 用户无法在该板块下发布新帖

#### 4.3 业务规则

**删除权限**：

- 仅管理员可以删除板块

**删除确认**：

- 删除操作需要二次确认
- 提示板块内的帖子数量
- 确认是否继续删除

**删除限制**：

- 如果板块内有帖子，建议禁用而非删除
- 系统至少保留 1 个启用的板块

**删除后处理**：

- 软删除的板块可以恢复
- 硬删除的板块无法恢复

#### 4.4 交互流程

1. 管理员进入"板块管理"页面
2. 找到需要删除的板块
3. 点击"删除"按钮
4. 显示确认对话框：
   - 提示板块内有 X 篇帖子
   - 询问是否确认删除
5. 管理员确认
6. 系统执行删除操作
7. 显示"板块已删除"提示

---

### 5. 启用/禁用板块（管理员功能）

#### 5.1 业务场景

**使用场景**：管理员需要临时关闭某个板块，但不删除板块数据。

**用户故事**：

- 作为管理员，我希望能够禁用某个板块，暂时停止该板块的使用。
- 作为管理员，我希望能够恢复被禁用的板块，重新开放讨论。

#### 5.2 功能说明

管理员可以将板块设置为启用或禁用状态。

**操作选项**：

- 启用板块：板块正常显示和使用
- 禁用板块：板块不显示，无法发帖

**影响范围**：

- 禁用后，板块不显示在板块列表中
- 该板块下的已有帖子仍然可以访问
- 用户无法在该板块下发布新帖

#### 5.3 业务规则

**操作权限**：

- 仅管理员可以启用/禁用板块

**禁用限制**：

- 系统至少保留 1 个启用的板块
- 最后一个启用的板块无法禁用

**禁用影响**：

- 板块不显示在侧边栏
- 已有帖子仍可访问（通过搜索或链接）
- 帖子详情页显示板块名称（灰色标识）

#### 5.4 交互流程

**禁用板块**：

1. 管理员进入"板块管理"页面
2. 找到需要禁用的板块
3. 点击"禁用"按钮
4. 确认操作
5. 系统更新板块状态
6. 显示"板块已禁用"提示

**启用板块**：

1. 管理员进入"板块管理"页面
2. 找到被禁用的板块
3. 点击"启用"按钮
4. 确认操作
5. 系统更新板块状态
6. 显示"板块已启用"提示

---

### 6. 调整板块排序（管理员功能）

#### 6.1 业务场景

**使用场景**：管理员需要调整板块的显示顺序，将重要板块放在前面。

**用户故事**：

- 作为管理员，我希望能够调整板块的显示顺序，将热门板块排在前面。
- 作为管理员，我希望能够通过拖拽的方式快速调整顺序。

#### 6.2 功能说明

管理员可以调整板块在列表中的显示顺序。

**调整方式**：

- 拖拽排序：拖动板块到目标位置
- 输入序号：直接输入排序号

**显示效果**：

- 排序号小的板块显示在前面
- 实时更新侧边栏的板块顺序

#### 6.3 业务规则

**操作权限**：

- 仅管理员可以调整排序

**排序规则**：

- 排序号范围 1-999
- 可以有相同的排序号（按创建时间次要排序）
- 排序号可以不连续

**影响范围**：

- 仅影响板块的显示顺序
- 不影响板块内的帖子

#### 6.4 交互流程

**拖拽排序**：

1. 管理员进入"板块管理"页面
2. 拖动某个板块到目标位置
3. 松开鼠标
4. 系统自动更新排序号
5. 显示"排序已更新"提示

**输入序号**：

1. 管理员进入"板块管理"页面
2. 点击板块的"编辑"按钮
3. 修改排序号
4. 点击"保存"
5. 系统更新排序
6. 板块列表重新排序

---

### 7. 查看板块详情

#### 7.1 业务场景

**使用场景**：

- 用户想了解某个板块的详细信息和规则
- 管理员查看板块的配置信息

**用户故事**：

- 作为一个论坛用户，我希望能够查看板块的详细说明，了解适合发布什么类型的内容。

#### 7.2 功能说明

显示板块的完整信息和统计数据。

**显示信息**：

- 板块名称
- 板块标识
- 板块描述
- 板块图标
- 板块颜色
- 创建时间
- 统计数据：
  - 帖子总数
  - 今日新增帖子数
  - 总回复数
- 板块规则说明（可选）

#### 7.3 业务规则

**查看权限**：

- 所有用户都可以查看板块详情

**显示内容**：

- 启用的板块显示完整信息
- 禁用的板块仅管理员可查看

#### 7.4 交互流程

1. 用户点击板块名称
2. 显示板块详情页（或弹窗）
3. 展示板块的描述和规则
4. 显示板块统计数据
5. 显示该板块的最新帖子

---

### 8. 查看板块统计（管理员功能）

#### 8.1 业务场景

**使用场景**：管理员想了解各个板块的活跃度和内容情况。

**用户故事**：

- 作为管理员，我希望能够查看每个板块的帖子数量和活跃度，了解社区运营情况。

#### 8.2 功能说明

管理员可以查看板块的详细统计数据。

**统计信息**：

- 帖子总数
- 回复总数
- 今日新增帖子
- 本周新增帖子
- 本月新增帖子
- 平均回复数
- 最后发帖时间

**显示方式**：

- 列表形式展示所有板块统计
- 支持按各项指标排序

#### 8.3 业务规则

**查看权限**：

- 仅管理员可以查看详细统计

**统计范围**：

- 仅统计未删除的帖子
- 仅统计启用板块的数据

#### 8.4 交互流程

1. 管理员进入"板块管理"页面
2. 查看板块列表和统计数据
3. 点击"查看详情"查看单个板块的详细统计
4. 可以按帖子数、活跃度等排序

---

## 预设板块

### 初始板块配置

系统初始化时，预设以下 6 个板块：

| 板块标识 | 板块名称 | 描述                   | 图标图片              | 颜色            | 排序 |
| -------- | -------- | ---------------------- | --------------------- | --------------- | ---- |
| tech     | 技术交流 | 分享编程技术和开发经验 | tech-icon.png         | #1976D2（蓝色） | 1    |
| design   | 设计分享 | UI/UX 设计作品和心得   | design-icon.png       | #9C27B0（紫色） | 2    |
| discuss  | 综合讨论 | 各类话题的自由讨论     | discuss-icon.png      | #4CAF50（绿色） | 3    |
| question | 问答求助 | 技术问题求助和解答     | question-icon.png     | #FF9800（橙色） | 4    |
| share    | 资源分享 | 工具、教程等资源推荐   | share-icon.png        | #00BCD4（青色） | 5    |
| announce | 公告通知 | 官方公告和重要通知     | announcement-icon.png | #F44336（红色） | 6    |

---

## 测试场景

### 1. 浏览板块测试场景

| 场景编号 | 测试场景     | 操作步骤     | 预期结果             |
| -------- | ------------ | ------------ | -------------------- |
| TC-001   | 查看板块列表 | 访问首页     | 侧边栏显示所有板块   |
| TC-002   | 板块排序     | 查看板块列表 | 按排序号升序显示     |
| TC-003   | 板块筛选     | 点击某个板块 | 显示该板块的帖子列表 |
| TC-004   | 板块统计     | 查看板块列表 | 显示每个板块的帖子数 |
| TC-005   | 禁用板块隐藏 | 查看板块列表 | 不显示禁用的板块     |

### 2. 创建板块测试场景

| 场景编号 | 测试场景     | 操作步骤                   | 预期结果                                 |
| -------- | ------------ | -------------------------- | ---------------------------------------- |
| TC-101   | 正常创建     | 填写所有必填信息，点击创建 | 创建成功，板块显示在列表中               |
| TC-102   | 名称为空     | 不填写名称                 | 提示"请输入板块名称"                     |
| TC-103   | 名称重复     | 输入已存在的板块名称       | 提示"板块名称已存在"                     |
| TC-104   | 标识重复     | 输入已存在的板块标识       | 提示"板块标识已存在"                     |
| TC-105   | 标识格式错误 | 输入包含大写字母的标识     | 提示"标识只能包含小写字母、数字、下划线" |
| TC-106   | 未选择颜色   | 不选择板块颜色             | 提示"请选择板块颜色"                     |

### 3. 编辑板块测试场景

| 场景编号 | 测试场景     | 操作步骤             | 预期结果                   |
| -------- | ------------ | -------------------- | -------------------------- |
| TC-201   | 正常编辑     | 修改板块名称，保存   | 编辑成功，信息已更新       |
| TC-202   | 修改标识     | 尝试修改板块标识     | 标识字段不可编辑           |
| TC-203   | 修改图标     | 上传新的板块图标图片 | 图标更新，板块列表同步变化 |
| TC-204   | 修改颜色     | 修改板块颜色         | 颜色更新，徽章同步变化     |
| TC-205   | 修改排序号   | 修改排序号           | 板块顺序调整               |
| TC-206   | 普通用户编辑 | 普通用户尝试编辑板块 | 无权限访问管理页面         |

### 4. 删除板块测试场景

| 场景编号 | 测试场景       | 操作步骤             | 预期结果                     |
| -------- | -------------- | -------------------- | ---------------------------- |
| TC-301   | 删除空板块     | 删除没有帖子的板块   | 删除成功                     |
| TC-302   | 删除有帖子板块 | 删除包含帖子的板块   | 提示"板块内有帖子，建议禁用" |
| TC-303   | 删除最后板块   | 删除最后一个启用板块 | 提示"至少保留一个板块"       |
| TC-304   | 恢复已删除板块 | 恢复软删除的板块     | 板块重新显示                 |

### 5. 启用/禁用板块测试场景

| 场景编号 | 测试场景     | 操作步骤         | 预期结果               |
| -------- | ------------ | ---------------- | ---------------------- |
| TC-401   | 禁用板块     | 点击"禁用"，确认 | 板块不再显示           |
| TC-402   | 启用板块     | 点击"启用"，确认 | 板块重新显示           |
| TC-403   | 禁用最后板块 | 禁用最后一个板块 | 提示"至少保留一个板块" |
| TC-404   | 禁用后发帖   | 在禁用板块下发帖 | 无法选择该板块         |

### 6. 调整排序测试场景

| 场景编号 | 测试场景 | 操作步骤           | 预期结果           |
| -------- | -------- | ------------------ | ------------------ |
| TC-501   | 拖拽排序 | 拖动板块到目标位置 | 顺序更新           |
| TC-502   | 输入序号 | 修改排序号为 1     | 板块移到第一位     |
| TC-503   | 相同序号 | 两个板块序号相同   | 按创建时间次要排序 |

---

## 功能清单

### 普通用户功能

- [x] 浏览板块列表
- [x] 查看板块详情
- [x] 按板块筛选帖子

### 管理员功能

- [x] 创建板块
- [x] 编辑板块
- [x] 删除板块
- [x] 启用/禁用板块
- [x] 调整板块排序
- [x] 查看板块统计

---

**文档版本：** v1.0（纯需求版）  
**创建日期：** 2025-10-27  
**最后更新：** 2025-10-27  
**文档类型：** 产品需求文档（PRD）

<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>æ¿å—ç®¡ç† - Open436 è®ºå›</title>
  <link rel="stylesheet" href="../css/common.css">
  <style>
    body {
      display: flex;
      min-height: 100vh;
    }

    .main-content {
      flex: 1;
      margin-left: 260px;
      padding: var(--space-xl);
      background: var(--background-secondary);
    }

    .page-header {
      margin-bottom: var(--space-xl);
    }

    .page-title {
      font-size: 28px;
      font-weight: 600;
      color: var(--text-primary);
      margin-bottom: var(--space-sm);
    }

    .page-description {
      color: var(--text-secondary);
    }

    .toolbar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: var(--space-lg);
    }

    .sections-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: var(--space-lg);
    }

    .section-card {
      background: white;
      border-radius: var(--radius-md);
      padding: var(--space-lg);
      box-shadow: var(--shadow-sm);
      transition: all var(--transition-fast);
    }

    .section-card:hover {
      box-shadow: var(--shadow-md);
      transform: translateY(-2px);
    }

    .section-header {
      display: flex;
      align-items: center;
      gap: var(--space-md);
      margin-bottom: var(--space-base);
    }

    .section-icon {
      width: 48px;
      height: 48px;
      border-radius: var(--radius-sm);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
    }

    .section-info {
      flex: 1;
    }

    .section-name {
      font-size: 18px;
      font-weight: 600;
      color: var(--text-primary);
      margin-bottom: 4px;
    }

    .section-slug {
      font-size: 14px;
      color: var(--text-secondary);
    }

    .section-stats {
      display: flex;
      gap: var(--space-lg);
      margin-bottom: var(--space-base);
      padding: var(--space-base) 0;
      border-top: 1px solid var(--divider);
      border-bottom: 1px solid var(--divider);
    }

    .stat-item {
      text-align: center;
    }

    .stat-value {
      font-size: 20px;
      font-weight: 600;
      color: var(--text-primary);
    }

    .stat-label {
      font-size: 12px;
      color: var(--text-secondary);
      margin-top: 4px;
    }

    .section-actions {
      display: flex;
      gap: var(--space-sm);
    }

    .btn-icon {
      padding: var(--space-xs) var(--space-sm);
      border: 1px solid var(--divider);
      background: white;
      border-radius: var(--radius-sm);
      cursor: pointer;
      transition: all var(--transition-fast);
      font-size: 14px;
    }

    .btn-icon:hover {
      border-color: var(--primary);
      color: var(--primary);
    }

    @media (max-width: 959px) {
      .main-content {
        margin-left: 0;
      }

      .sections-grid {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <!-- Sidebar Container -->
  <div id="admin-sidebar-container"></div>

  <!-- Main Content -->
  <main class="main-content">
    <div class="page-header">
      <h1 class="page-title">æ¿å—ç®¡ç†</h1>
      <p class="page-description">ç®¡ç†è®ºå›æ¿å—åˆ†ç±»å’Œè®¾ç½®</p>
    </div>

    <div class="toolbar">
      <div></div>
      <button class="btn btn-primary" onclick="addSection()">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width: 18px; height: 18px; margin-right: 8px;">
          <line x1="12" y1="5" x2="12" y2="19"></line>
          <line x1="5" y1="12" x2="19" y2="12"></line>
        </svg>
        æ·»åŠ æ¿å—
      </button>
    </div>

    <div class="sections-grid" id="sectionsGrid">
      <!-- Sections will be loaded here -->
    </div>
  </main>

  <script src="../js/common.js"></script>
  <script src="components/sidebar.js"></script>
  <script>
    // Check admin permission
    const currentUser = JSON.parse(localStorage.getItem('currentUser'));
    if (!currentUser || currentUser.role !== 'admin') {
      window.location.href = '../pages/home.html';
    }

    // Initialize sidebar
    initAdminSidebar('sections');

    // Mock sections data
    const sections = [
      {
        id: 'tech',
        name: 'æŠ€æœ¯äº¤æµ',
        slug: 'tech',
        icon: 'ğŸ’»',
        color: '#1976D2',
        description: 'åˆ†äº«æŠ€æœ¯ç»éªŒï¼Œæ¢è®¨ç¼–ç¨‹é—®é¢˜',
        posts: 156,
        members: 1234,
        order: 1,
        enabled: true
      },
      {
        id: 'design',
        name: 'è®¾è®¡åˆ†äº«',
        slug: 'design',
        icon: 'ğŸ¨',
        color: '#FF6F00',
        description: 'å±•ç¤ºè®¾è®¡ä½œå“ï¼Œäº¤æµè®¾è®¡ç†å¿µ',
        posts: 89,
        members: 567,
        order: 2,
        enabled: true
      },
      {
        id: 'discuss',
        name: 'ç»¼åˆè®¨è®º',
        slug: 'discuss',
        icon: 'ğŸ’¬',
        color: '#4CAF50',
        description: 'ç•…æ‰€æ¬²è¨€ï¼Œè®¨è®ºå„ç§è¯é¢˜',
        posts: 234,
        members: 890,
        order: 3,
        enabled: true
      },
      {
        id: 'question',
        name: 'é—®ç­”æ±‚åŠ©',
        slug: 'question',
        icon: 'â“',
        color: '#9C27B0',
        description: 'æå‡ºé—®é¢˜ï¼Œå¯»æ±‚å¸®åŠ©å’Œå»ºè®®',
        posts: 178,
        members: 456,
        order: 4,
        enabled: true
      },
      {
        id: 'share',
        name: 'èµ„æºåˆ†äº«',
        slug: 'share',
        icon: 'ğŸ“¦',
        color: '#FF9800',
        description: 'åˆ†äº«ä¼˜è´¨èµ„æºï¼Œå…±åŒå­¦ä¹ è¿›æ­¥',
        posts: 123,
        members: 678,
        order: 5,
        enabled: true
      },
      {
        id: 'announce',
        name: 'å…¬å‘Šé€šçŸ¥',
        slug: 'announce',
        icon: 'ğŸ“¢',
        color: '#F44336',
        description: 'æŸ¥çœ‹è®ºå›å…¬å‘Šå’Œé‡è¦é€šçŸ¥',
        posts: 45,
        members: 2000,
        order: 6,
        enabled: true
      }
    ];

    function renderSections() {
      const grid = document.getElementById('sectionsGrid');
      
      grid.innerHTML = sections.map(section => `
        <div class="section-card">
          <div class="section-header">
            <div class="section-icon" style="background: ${section.color}20; color: ${section.color};">
              ${section.icon}
            </div>
            <div class="section-info">
              <div class="section-name">${section.name}</div>
              <div class="section-slug">/${section.slug}</div>
            </div>
          </div>

          <p style="color: var(--text-secondary); font-size: 14px; margin-bottom: var(--space-base);">
            ${section.description}
          </p>

          <div class="section-stats">
            <div class="stat-item">
              <div class="stat-value">${section.posts}</div>
              <div class="stat-label">å¸–å­æ•°</div>
            </div>
            <div class="stat-item">
              <div class="stat-value">${section.members}</div>
              <div class="stat-label">æˆå‘˜æ•°</div>
            </div>
            <div class="stat-item">
              <div class="stat-value">${section.order}</div>
              <div class="stat-label">æ’åº</div>
            </div>
          </div>

          <div class="section-actions">
            <button class="btn-icon" onclick="editSection('${section.id}')">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width: 16px; height: 16px; margin-right: 4px;">
                <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
              </svg>
              ç¼–è¾‘
            </button>
            <button class="btn-icon" onclick="toggleSection('${section.id}')">
              ${section.enabled ? 'ç¦ç”¨' : 'å¯ç”¨'}
            </button>
            <button class="btn-icon" style="color: var(--error);" onclick="deleteSection('${section.id}')">
              åˆ é™¤
            </button>
          </div>
        </div>
      `).join('');
    }

    function addSection() {
      showAlert('æ·»åŠ æ¿å—åŠŸèƒ½å¼€å‘ä¸­...');
    }

    function editSection(id) {
      const section = sections.find(s => s.id === id);
      if (section) {
        showAlert(`ç¼–è¾‘æ¿å—ï¼š${section.name}`);
      }
    }

    function toggleSection(id) {
      const section = sections.find(s => s.id === id);
      if (section) {
        section.enabled = !section.enabled;
        renderSections();
        showToast(`æ¿å—å·²${section.enabled ? 'å¯ç”¨' : 'ç¦ç”¨'}`, 'success');
      }
    }

    function deleteSection(id) {
      showConfirm('ç¡®å®šè¦åˆ é™¤è¿™ä¸ªæ¿å—å—ï¼Ÿåˆ é™¤åæ— æ³•æ¢å¤ã€‚', () => {
        const index = sections.findIndex(s => s.id === id);
        if (index > -1) {
          sections.splice(index, 1);
          renderSections();
          showToast('æ¿å—å·²åˆ é™¤', 'success');
        }
      });
    }

    // Initialize
    renderSections();
  </script>
</body>
</html>
